[gd_scene load_steps=32 format=3]

[ext_resource type="Script" path="res://Scenes/World/main.gd" id="1"]
[ext_resource type="PackedScene" path="res://Actors/Player/Player.tscn" id="2"]
[ext_resource type="Script" path="res://Systems/camera_controller.gd" id="3"]
[ext_resource type="PackedScene" path="res://UI/HUD/HUD.tscn" id="4"]
[ext_resource type="PackedScene" path="res://Scenes/World/Tree.tscn" id="tree"]
[ext_resource type="PackedScene" path="res://Scenes/World/OakTree.tscn" id="oak"]
[ext_resource type="PackedScene" path="res://Scenes/World/CopperRock.tscn" id="rock"]
[ext_resource type="PackedScene" path="res://Scenes/World/FishingSpot.tscn" id="fish"]
[ext_resource type="PackedScene" path="res://Actors/Enemies/Goblin.tscn" id="goblin"]
[ext_resource type="PackedScene" path="res://Actors/Enemies/Skeleton.tscn" id="skeleton"]
[ext_resource type="Resource" path="res://Data/DropTables/logs_drop.tres" id="9"]
[ext_resource type="Resource" path="res://Data/DropTables/oak_logs_drop.tres" id="10"]
[ext_resource type="Resource" path="res://Data/DropTables/copper_ore_drop.tres" id="11"]
[ext_resource type="Resource" path="res://Data/DropTables/raw_shrimps_drop.tres" id="12"]
[ext_resource type="Resource" path="res://Data/DropTables/bones_drop.tres" id="13"]
[ext_resource type="Resource" path="res://Data/DropTables/coins_drop.tres" id="14"]
[ext_resource type="PackedScene" path="res://Scenes/World/CookingFire.tscn" id="fire"]
[ext_resource type="PackedScene" path="res://Actors/NPCs/NPC.tscn" id="npc"]
[ext_resource type="PackedScene" path="res://Scenes/World/TroutSpot.tscn" id="trout"]
[ext_resource type="Resource" path="res://Data/DropTables/bronze_sword_drop.tres" id="20"]
[ext_resource type="Resource" path="res://Data/DropTables/iron_sword_drop.tres" id="21"]
[ext_resource type="Resource" path="res://Data/DropTables/raw_trout_drop.tres" id="22"]
[ext_resource type="Resource" path="res://Data/Weapons/bronze_sword.tres" id="shop_bsword"]
[ext_resource type="Resource" path="res://Data/Weapons/iron_sword.tres" id="shop_isword"]
[ext_resource type="Resource" path="res://Data/Weapons/bronze_axe.tres" id="shop_baxe"]
[ext_resource type="Resource" path="res://Data/Weapons/iron_axe.tres" id="shop_iaxe"]
[ext_resource type="Resource" path="res://Data/Armor/bronze_platebody.tres" id="shop_bplate"]
[ext_resource type="Resource" path="res://Data/Armor/bronze_med_helm.tres" id="shop_bhelm"]

[sub_resource type="PlaneMesh" id="PlaneMesh_1"]
size = Vector2(80, 80)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_grass"]
shading_mode = 0
albedo_color = Color(0.25, 0.5, 0.18, 1)

[sub_resource type="BoxShape3D" id="BoxShape3D_ground"]
size = Vector3(80, 0.1, 80)

[sub_resource type="NavigationMesh" id="NavigationMesh_1"]
vertices = PackedVector3Array(-40, 0, -40, -40, 0, 40, 40, 0, 40, 40, 0, -40)
polygons = [PackedInt32Array(0, 1, 2, 3)]
agent_radius = 0.4

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_dirt_path"]
shading_mode = 0
albedo_color = Color(0.45, 0.35, 0.2, 1)

[sub_resource type="PlaneMesh" id="PlaneMesh_path1"]
size = Vector2(3, 20)

[sub_resource type="PlaneMesh" id="PlaneMesh_path2"]
size = Vector2(25, 3)

; ==================== MAIN SCENE ====================

[node name="Main" type="Node3D"]
script = ExtResource("1")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.866, -0.25, 0.433, 0, 0.866, 0.5, -0.5, -0.433, 0.75, 0, 15, 0)
light_energy = 1.2

[node name="AmbientLight" type="DirectionalLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.707, 0.707, 0, -0.707, 0.707, 0, 10, 0)
light_color = Color(0.7, 0.75, 0.9, 1)
light_energy = 0.3

[node name="Ground" type="StaticBody3D" parent="."]
collision_layer = 1
collision_mask = 0

[node name="GroundMesh" type="MeshInstance3D" parent="Ground"]
mesh = SubResource("PlaneMesh_1")
material_override = SubResource("StandardMaterial3D_grass")

[node name="GroundCollision" type="CollisionShape3D" parent="Ground"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.05, 0)
shape = SubResource("BoxShape3D_ground")

[node name="DirtPathNS" type="MeshInstance3D" parent="Ground"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.01, 0)
mesh = SubResource("PlaneMesh_path1")
material_override = SubResource("StandardMaterial3D_dirt_path")

[node name="DirtPathEW" type="MeshInstance3D" parent="Ground"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.01, 0)
mesh = SubResource("PlaneMesh_path2")
material_override = SubResource("StandardMaterial3D_dirt_path")

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="."]
navigation_mesh = SubResource("NavigationMesh_1")

[node name="Player" parent="." instance=ExtResource("2")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2, 0, 2)

[node name="CameraController" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0)
script = ExtResource("3")

[node name="Camera3D" type="Camera3D" parent="CameraController"]
fov = 50.0

; ==================== FOREST ZONE ====================

[node name="ForestZone" type="Node3D" parent="."]

[node name="Tree1" parent="ForestZone" instance=ExtResource("tree")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 6, 0, 4)
drop_table = [ExtResource("9")]

[node name="Tree2" parent="ForestZone" instance=ExtResource("tree")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 10, 0, 2)
drop_table = [ExtResource("9")]

[node name="Tree3" parent="ForestZone" instance=ExtResource("tree")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 0, 8)
drop_table = [ExtResource("9")]

[node name="Tree4" parent="ForestZone" instance=ExtResource("tree")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 12, 0, 6)
drop_table = [ExtResource("9")]

[node name="Tree5" parent="ForestZone" instance=ExtResource("tree")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4, 0, 10)
drop_table = [ExtResource("9")]

[node name="OakTree1" parent="ForestZone" instance=ExtResource("oak")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 16, 0, 8)
drop_table = [ExtResource("10")]

[node name="OakTree2" parent="ForestZone" instance=ExtResource("oak")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 19, 0, 4)
drop_table = [ExtResource("10")]

[node name="OakTree3" parent="ForestZone" instance=ExtResource("oak")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 14, 0, 12)
drop_table = [ExtResource("10")]

; ==================== MINING ZONE ====================

[node name="MiningZone" type="Node3D" parent="."]

[node name="CopperRock1" parent="MiningZone" instance=ExtResource("rock")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10, 0, 6)
drop_table = [ExtResource("11")]

[node name="CopperRock2" parent="MiningZone" instance=ExtResource("rock")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -12, 0, 8)
drop_table = [ExtResource("11")]

[node name="CopperRock3" parent="MiningZone" instance=ExtResource("rock")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8, 0, 10)
drop_table = [ExtResource("11")]

[node name="CopperRock4" parent="MiningZone" instance=ExtResource("rock")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -14, 0, 5)
drop_table = [ExtResource("11")]

; ==================== FISHING ZONE ====================

[node name="FishingZone" type="Node3D" parent="."]

[node name="FishingSpot1" parent="FishingZone" instance=ExtResource("fish")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4, 0, -10)
drop_table = [ExtResource("12")]

[node name="FishingSpot2" parent="FishingZone" instance=ExtResource("fish")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, -12)
drop_table = [ExtResource("12")]

[node name="FishingSpot3" parent="FishingZone" instance=ExtResource("fish")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8, 0, -13)
drop_table = [ExtResource("12")]

; ==================== GOBLIN CAMP ====================

[node name="GoblinCamp" type="Node3D" parent="."]

[node name="Goblin1" parent="GoblinCamp" instance=ExtResource("goblin")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -15, 0, -8)
drop_table = [ExtResource("13"), ExtResource("14"), ExtResource("20")]

[node name="Goblin2" parent="GoblinCamp" instance=ExtResource("goblin")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -18, 0, -6)
drop_table = [ExtResource("13"), ExtResource("14"), ExtResource("20")]

[node name="Goblin3" parent="GoblinCamp" instance=ExtResource("goblin")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -20, 0, -10)
max_hp = 7
attack_damage = 3
aggro_range = 6.0
combat_level = 3
xp_reward = 30.0
drop_table = [ExtResource("13"), ExtResource("14")]

[node name="Goblin4" parent="GoblinCamp" instance=ExtResource("goblin")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -13, 0, -11)
drop_table = [ExtResource("13"), ExtResource("14")]

; ==================== SKELETON GRAVEYARD ====================

[node name="SkeletonGraveyard" type="Node3D" parent="."]

[node name="Skeleton1" parent="SkeletonGraveyard" instance=ExtResource("skeleton")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 18, 0, -10)
drop_table = [ExtResource("13"), ExtResource("14"), ExtResource("21")]

[node name="Skeleton2" parent="SkeletonGraveyard" instance=ExtResource("skeleton")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 22, 0, -8)
drop_table = [ExtResource("13"), ExtResource("14"), ExtResource("21")]

[node name="Skeleton3" parent="SkeletonGraveyard" instance=ExtResource("skeleton")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 20, 0, -14)
max_hp = 20
attack_damage = 5
aggro_range = 7.0
combat_level = 15
xp_reward = 80.0
drop_table = [ExtResource("13"), ExtResource("14"), ExtResource("21")]

; ==================== COOKING FIRES ====================

[node name="CookingZone" type="Node3D" parent="."]

[node name="CookingFire1" parent="CookingZone" instance=ExtResource("fire")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2, 0, -8)

[node name="CookingFire2" parent="CookingZone" instance=ExtResource("fire")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 5, 0, -2)

; ==================== TROUT FISHING ====================

[node name="TroutSpot1" parent="FishingZone" instance=ExtResource("trout")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 5, 0, -15)
drop_table = [ExtResource("22")]

[node name="TroutSpot2" parent="FishingZone" instance=ExtResource("trout")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2, 0, -16)
drop_table = [ExtResource("22")]

; ==================== NPC VILLAGE ====================

[node name="Village" type="Node3D" parent="."]

[node name="Guide" parent="Village" instance=ExtResource("npc")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4, 0, 4)
display_name = "Guide"
npc_role = "talk"
dialogue_lines = ["Welcome to AI RPG, adventurer!", "Tap objects to interact with them.", "Fight goblins to the west, or try fishing to the south.", "You can cook raw food at a cooking fire.", "Bury bones for Prayer experience!", "Talk to the shopkeepers to buy equipment."]

[node name="Hans" parent="Village" instance=ExtResource("npc")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2, 0, 3)
display_name = "Hans"
npc_role = "talk"
dialogue_lines = ["Hello there! I've been here for ages.", "This village has been peaceful, mostly.", "Watch out for the skeletons to the east!", "I hear the goblins have been causing trouble lately."]

[node name="WeaponShop" parent="Village" instance=ExtResource("npc")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 0, -4)
display_name = "Weapon Smith"
npc_role = "merchant"
dialogue_lines = ["Looking for a fine weapon?"]
shop_items = [ExtResource("shop_bsword"), ExtResource("shop_isword"), ExtResource("shop_baxe"), ExtResource("shop_iaxe")]
shop_prices = [26, 91, 16, 56]

[node name="ArmorShop" parent="Village" instance=ExtResource("npc")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 10, 0, -2)
display_name = "Armorer"
npc_role = "merchant"
dialogue_lines = ["Need some protection?"]
shop_items = [ExtResource("shop_bplate"), ExtResource("shop_bhelm")]
shop_prices = [160, 24]

; ==================== HUD ====================

[node name="HUD" parent="." instance=ExtResource("4")]
